<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hist√≥rias B√≠blicas - Pequenos Disc√≠pulos</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos CSS (mantidos da vers√£o anterior) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Comic Neue', cursive; background: linear-gradient(135deg, #87CEEB, #98FB98); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        .header { background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 15px 0; position: relative; }
        .logo-header { display: flex; align-items: center; gap: 15px; }
        .header-logo { width: 60px; height: 60px; border-radius: 50%; }
        .header-text h1 { color: #2E8B57; font-size: 1.8rem; }
        .header-subtitle { color: #666; font-size: 1rem; }
        .btn-voltar { background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-family: 'Comic Neue', cursive; font-weight: 600; position: absolute; top: 20px; right: 20px; }
        
        .banner-secao { padding: 60px 0; text-align: center; background: rgba(255,255,255,0.1); }
        .banner-content h2 { font-size: 3rem; color: #2E8B57; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .banner-content p { font-size: 1.3rem; color: #333; margin-bottom: 10px; font-weight: 600; }
        
        .filtros-historias { padding: 30px 0; }
        .filtros-historias h3 { text-align: center; color: #2E8B57; font-size: 1.5rem; margin-bottom: 20px; }
        .categorias-grid { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .btn-categoria { background: white; border: 2px solid #ddd; color: #666; padding: 10px 20px; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-family: 'Comic Neue', cursive; font-weight: 600; }
        .btn-categoria.active, .btn-categoria:hover { background: #4CAF50; border-color: #4CAF50; color: white; transform: translateY(-2px); }
        
        .historias-grid-section { padding: 40px 0; }
        .historias-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
        .historia-card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); transition: all 0.3s ease; border: 3px solid transparent; text-align: center; position: relative; overflow: hidden; }
        .historia-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 5px; background: linear-gradient(90deg, #4CAF50, #FFD700, #FF6347); }
        .historia-card:hover { transform: translateY(-8px); box-shadow: 0 15px 35px rgba(0,0,0,0.15); border-color: #FFD700; }
        .historia-icon { font-size: 3.5rem; margin-bottom: 20px; display: block; }
        .historia-info h3 { color: #2E8B57; font-size: 1.4rem; margin-bottom: 15px; line-height: 1.3; }
        .historia-info p { color: #666; margin-bottom: 15px; line-height: 1.5; }
        .categoria-tag { background: linear-gradient(45deg, #4CAF50, #2E8B57); color: white; padding: 6px 15px; border-radius: 20px; font-size: 0.9rem; font-weight: 600; display: inline-block; margin-bottom: 20px; }
        .historia-acoes { display: flex; justify-content: center; gap: 12px; }
        .btn-ler, .btn-ouvir { background: #4CAF50; color: white; border: none; padding: 12px 20px; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-family: 'Comic Neue', cursive; font-weight: 600; font-size: 0.95rem; }
        .btn-ouvir { background: #FF6347; }
        .btn-ler:hover, .btn-ouvir:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
        
        .modal-historia { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-content-historia { background: white; border-radius: 25px; max-width: 900px; max-height: 90vh; overflow-y: auto; box-shadow: 0 25px 60px rgba(0,0,0,0.3); width: 100%; }
        .modal-header-historia { background: linear-gradient(45deg, #4CAF50, #2E8B57); color: white; padding: 25px; border-radius: 25px 25px 0 0; display: flex; justify-content: space-between; align-items: center; }
        .modal-header-historia h3 { margin: 0; font-size: 1.6rem; }
        .btn-fechar-historia { background: transparent; border: none; color: white; font-size: 1.8rem; cursor: pointer; padding: 8px; border-radius: 8px; transition: background 0.3s ease; }
        .btn-fechar-historia:hover { background: rgba(255,255,255,0.2); }
        .modal-body-historia { padding: 30px; }
        .historia-visualizador { display: flex; gap: 30px; margin-bottom: 30px; align-items: flex-start; }
        .ilustracao-container { flex: 0 0 150px; text-align: center; }
        .ilustracao-imagem { font-size: 6rem; background: linear-gradient(135deg, #FFE4E1, #F0F8FF); border-radius: 20px; padding: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); margin-bottom: 15px; }
        .texto-container { flex: 1; }
        .texto-historia { background: #f8f9fa; padding: 25px; border-radius: 15px; border-left: 5px solid #4CAF50; line-height: 1.8; font-size: 1.1rem; color: #333; }
        .controles-historia { border-top: 2px solid #f0f0f0; padding-top: 25px; }
        .navegacao-paginas { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .btn-nav { background: #4CAF50; color: white; border: none; padding: 12px 20px; border-radius: 25px; cursor: pointer; font-family: 'Comic Neue', cursive; font-weight: 600; transition: all 0.3s ease; }
        .btn-nav:disabled { background: #ccc; cursor: not-allowed; transform: none; }
        .btn-nav:not(:disabled):hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        /* OCULTA O BOT√ÉO VERDE DE PAGINA√á√ÉO */
        .pagina-info { display: none !important; } 
        
        .controles-audio { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .btn-audio { background: #FF6347; color: white; border: none; padding: 12px 20px; border-radius: 25px; cursor: pointer; font-family: 'Comic Neue', cursive; font-weight: 600; transition: all 0.3s ease; }
        .btn-audio:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        
        /* Footer */
        .footer { background: #2E8B57; color: white; padding: 40px 0; text-align: center; }
        .footer-content { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; }
        .footer-logo { display: flex; align-items: center; gap: 15px; }
        .footer-logo img { width: 50px; height: 50px; border-radius: 50%; }
        .footer-info h4 { margin-bottom: 10px; }
        .footer-info p { margin-bottom: 5px; }
        
        /* Utilit√°rios */
        .hidden { display: none !important; }
        
        /* Responsivo */
        @media (max-width: 768px) {
            .historia-visualizador { flex-direction: column; text-align: center; }
            .ilustracao-container { flex: none; }
            .ilustracao-imagem { font-size: 4rem; padding: 15px; }
            .navegacao-paginas { flex-direction: column; gap: 15px; }
            .controles-audio { flex-direction: column; align-items: center; }
            .footer-content { flex-direction: column; text-align: center; }
            .categorias-grid { flex-direction: column; align-items: center; }
            .historias-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo-header">
                <img src="../assets/images/logo-pequenos-discipulos.png" alt="Pequenos Disc√≠pulos" class="header-logo">
                <div class="header-text">
                    <h1>Pequenos Disc√≠pulos</h1>
                    <p class="header-subtitle">Minist√©rio Infantil</p>
                </div>
            </div>
            <button class="btn-voltar" onclick="window.location.href='../index.html'">üè† In√≠cio</button>
        </div>
    </header>

    <!-- Banner da Se√ß√£o -->
    <section class="banner-secao">
        <div class="container">
            <div class="banner-content">
                <h2>üìñ Hist√≥rias B√≠blicas</h2>
                <p>Lindas hist√≥rias da B√≠blia contadas de forma especial para as crian√ßas</p>
                <p>Igreja Cristo Vive de Paracambi/RJ</p>
            </div>
        </div>
    </section>

    <!-- Filtros de Categoria -->
    <section class="filtros-historias">
        <div class="container">
            <h3>üìÇ Escolha uma categoria:</h3>
            <div class="categorias-grid">
                <button class="btn-categoria active" onclick="filtrarCategoria('todas')">üìö Todas</button>
                <button class="btn-categoria" onclick="filtrarCategoria('jesus')">‚úùÔ∏è Jesus</button>
                <button class="btn-categoria" onclick="filtrarCategoria('antigo')">üìú Antigo</button>
                <button class="btn-categoria" onclick="filtrarCategoria('milagres')">‚ú® Milagres</button>
                <button class="btn-categoria" onclick="filtrarCategoria('natal')">üéÑ Natal</button>
            </div>
        </div>
    </section>

    <!-- Grid de Hist√≥rias -->
    <section class="historias-grid-section">
        <div class="container">
            <div class="historias-grid">
                <!-- Jesus e as Criancinhas -->
                <div class="historia-card" data-categoria="jesus">
                    <div class="historia-icon">üë∂</div>
                    <div class="historia-info">
                        <h3>Jesus e as Criancinhas</h3>
                        <p>Jesus aben√ßoa as crian√ßas com muito amor</p>
                        <span class="categoria-tag">‚úùÔ∏è Jesus</span>
                    </div>
                    <div class="historia-acoes">
                        <button class="btn-ler" onclick="abrirHistoria('jesus-criancas')">üìñ Ler</button>
                        <button class="btn-ouvir" onclick="abrirHistoriaComAudio('jesus-criancas')">üéß Ouvir</button>
                    </div>
                </div>

                <!-- No√© e a Arca -->
                <div class="historia-card" data-categoria="antigo">
                    <div class="historia-icon">üö¢</div>
                    <div class="historia-info">
                        <h3>No√© e a Arca</h3>
                        <p>A grande arca que salvou os animais</p>
                        <span class="categoria-tag">üìú Antigo</span>
                    </div>
                    <div class="historia-acoes">
                        <button class="btn-ler" onclick="abrirHistoria('noe-arca')">üìñ Ler</button>
                        <button class="btn-ouvir" onclick="abrirHistoriaComAudio('noe-arca')">üéß Ouvir</button>
                    </div>
                </div>

                <!-- Davi e Golias -->
                <div class="historia-card" data-categoria="antigo">
                    <div class="historia-icon">üóø</div>
                    <div class="historia-info">
                        <h3>Davi e Golias</h3>
                        <p>O pequeno pastor que venceu o gigante</p>
                        <span class="categoria-tag">üìú Antigo</span>
                    </div>
                    <div class="historia-acoes">
                        <button class="btn-ler" onclick="abrirHistoria('davi-golias')">üìñ Ler</button>
                        <button class="btn-ouvir" onclick="abrirHistoriaComAudio('davi-golias')">üéß Ouvir</button>
                    </div>
                </div>

                <!-- Daniel na Cova dos Le√µes -->
                <div class="historia-card" data-categoria="antigo milagres">
                    <div class="historia-icon">ÔøΩÔøΩ</div>
                    <div class="historia-info">
                        <h3>Daniel na Cova dos Le√µes</h3>
                        <p>Deus protege quem confia nEle</p>
                        <span class="categoria-tag">‚ú® Milagres</span>
                    </div>
                    <div class="historia-acoes">
                        <button class="btn-ler" onclick="abrirHistoria('daniel-leoes')">ÔøΩÔøΩ Ler</button>
                        <button class="btn-ouvir" onclick="abrirHistoriaComAudio('daniel-leoes')">ÔøΩÔøΩ Ouvir</button>
                    </div>
                </div>

                <!-- Jonas e a Baleia -->
                <div class="historia-card" data-categoria="antigo">
                    <div class="historia-icon">üêã</div>
                    <div class="historia-info">
                        <h3>Jonas e a Baleia</h3>
                        <p>A hist√≥ria do profeta desobediente</p>
                        <span class="categoria-tag">ÔøΩÔøΩ Antigo</span>
                    </div>
                    <div class="historia-acoes">
                        <button class="btn-ler" onclick="abrirHistoria('jonas-baleia')">üìñ Ler</button>
                        <button class="btn-ouvir" onclick="abrirHistoriaComAudio('jonas-baleia')">üéß Ouvir</button>
                    </div>
                </div>

                <!-- Nascimento de Jesus -->
                <div class="historia-card" data-categoria="jesus natal">
                    <div class="historia-icon">‚≠ê</div>
                    <div class="historia-info">
                        <h3>O Nascimento de Jesus</h3>
                        <p>O beb√™ que nasceu para salvar o mundo</p>
                        <span class="categoria-tag">üéÑ Natal</span>
                    </div>
                    <div class="historia-acoes">
                        <button class="btn-ler" onclick="abrirHistoria('nascimento-jesus')">üìñ Ler</button>
                        <button class="btn-ouvir" onclick="abrirHistoriaComAudio('nascimento-jesus')">üéß Ouvir</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="modal-historia" class="modal-historia hidden">
        <div class="modal-content-historia">
            <div class="modal-header-historia">
                <h3 id="historia-titulo">T√≠tulo da Hist√≥ria</h3>
                <button class="btn-fechar-historia" onclick="fecharHistoria()">‚ùå</button>
            </div>
            
            <div class="modal-body-historia">
                <div class="historia-visualizador">
                    <div class="ilustracao-container">
                        <div class="ilustracao-imagem" id="ilustracao-imagem">üë∂</div>
                    </div>
                    
                    <div class="texto-container">
                        <div class="texto-historia" id="texto-historia">
                            <p>Texto da hist√≥ria aparecer√° aqui...</p>
                        </div>
                    </div>
                </div>
                
                <div class="controles-historia">
                    <div class="navegacao-paginas">
                        <button class="btn-nav" id="btn-anterior" onclick="paginaAnterior()">‚¨ÖÔ∏è Anterior</button>
                        <span class="pagina-info" id="pagina-atual">1 / 5</span> <!-- Este √© o elemento ocultado via CSS -->
                        <button class="btn-nav" id="btn-proximo" onclick="proximaPagina()">Pr√≥ximo ‚û°Ô∏è</button>
                    </div>
                    
                    <div class="controles-audio">
                        <button class="btn-audio" id="btn-play-pause" onclick="togglePlayPause()">‚ñ∂Ô∏è Ouvir Hist√≥ria</button>
                        <button class="btn-audio" onclick="imprimirHistoria()">üñ®Ô∏è Imprimir</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="../assets/images/logo-pequenos-discipulos.png" alt="Pequenos Disc√≠pulos">
                    <h4>Pequenos Disc√≠pulos</h4>
                </div>
                <div class="footer-info">
                    <h4>Hist√≥rias B√≠blicas</h4>
                    <p>Contando as hist√≥rias de Deus com amor</p>
                    <p>Igreja Cristo Vive de Paracambi/RJ</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Dados das hist√≥rias
        const historiasData = {
            'jesus-criancas': {
                titulo: 'Jesus e as Criancinhas',
                textoCompleto: 'Era uma vez, em um lugar muito especial, onde Jesus estava ensinando as pessoas sobre o amor de Deus. Muitas mam√£es e papais trouxeram suas criancinhas para Jesus aben√ßoar. Mas os disc√≠pulos acharam que Jesus estava muito ocupado e tentaram mandar as crian√ßas embora. Jesus ficou triste com isso e disse: "Deixai vir a mim as criancinhas, e n√£o as impe√ßais, porque das tais √© o Reino dos c√©us!" E Jesus aben√ßoou cada criancinha com muito amor e carinho. Ele pegou as crian√ßas no colo, colocou as m√£os sobre elas e as aben√ßoou. Jesus mostrou que Ele ama todas as crian√ßas do mundo e quer que elas venham at√© Ele. As crian√ßas s√£o muito importantes para Jesus, e Ele sempre tem tempo para elas. Quando voc√™ orar, lembre-se de que Jesus te ama muito e quer ouvir sua voz. Voc√™ √© especial para Jesus!',
                paginas: [
                    { texto: 'Era uma vez, em um lugar muito especial, onde Jesus estava ensinando as pessoas sobre o amor de Deus...', ilustracao: 'üë∂' },
                    { texto: 'Muitas mam√£es e papais trouxeram suas criancinhas para Jesus aben√ßoar...', ilustracao: 'ÔøΩÔøΩ‚Äçüë©‚ÄçÔøΩÔøΩ‚Äçüë¶' },
                    { texto: 'Mas os disc√≠pulos acharam que Jesus estava muito ocupado e tentaram mandar as crian√ßas embora...', ilustracao: 'üö´' },
                    { texto: 'Jesus ficou triste com isso e disse: "Deixai vir a mim as criancinhas!"', ilustracao: '‚úùÔ∏è' },
                    { texto: 'E Jesus aben√ßoou cada criancinha com muito amor e carinho. Ele ama todas as crian√ßas!', ilustracao: 'üôè' }
                ]
            },
            'noe-arca': {
                titulo: 'No√© e a Arca',
                textoCompleto: 'H√° muito tempo, Deus viu que as pessoas estavam fazendo coisas ruins e n√£o obedeciam a Ele. Mas No√© era um homem bom que obedecia a Deus e orava todos os dias. Deus falou com No√© e pediu para ele construir uma arca muito grande, maior que um navio. No√© obedeceu a Deus e come√ßou a construir a arca com madeira forte. Deus disse para No√© colocar sua fam√≠lia e dois de cada animal na arca. Vieram os le√µes, os elefantes, as girafas, os coelhinhos, os passarinhos e muitos outros animais. Quando todos estavam dentro da arca, come√ßou a chover muito forte. Choveu por quarenta dias e quarenta noites! Mas todos na arca ficaram seguros porque Deus estava cuidando deles. Depois que parou de chover, Deus colocou um lindo arco-√≠ris no c√©u como promessa de que sempre cuidaria das pessoas que O obedecem. No√© e sua fam√≠lia sa√≠ram da arca e agradeceram a Deus por salv√°-los.',
                paginas: [
                    { texto: 'H√° muito tempo, Deus viu que as pessoas estavam fazendo coisas ruins...', ilustracao: 'üåç' },
                    { texto: 'Mas No√© era um homem bom que obedecia a Deus...', ilustracao: 'üë®' },
                    { texto: 'Deus pediu para No√© construir uma arca muito grande...', ilustracao: 'üö¢' },
                    { texto: 'No√© colocou sua fam√≠lia e dois de cada animal na arca...', ilustracao: 'ü¶ÅÔøΩÔøΩüê∞' },
                    { texto: 'Choveu muito, mas todos na arca ficaram seguros com Deus!', ilustracao: 'üåßÔ∏è' }
                ]
            },
            'davi-golias': {
                titulo: 'Davi e Golias',
                textoCompleto: 'Davi era um jovem pastor que cuidava das ovelhinhas no campo. Ele era pequeno, mas tinha um cora√ß√£o grande e confiava muito em Deus. Um dia, um gigante muito malvado chamado Golias estava assustando o povo de Deus. Golias era t√£o alto que chegava quase nas nuvens! Todos os soldados tinham medo dele. Mas Davi n√£o teve medo porque sabia que Deus estava com ele. Davi disse: "Eu vou lutar contra esse gigante!" Ele pegou apenas cinco pedrinhas lisas do riacho e sua funda. Quando Golias viu Davi, riu dele porque era muito pequeno. Mas Davi disse: "Voc√™ vem contra mim com espada, mas eu venho em nome do Senhor!" Davi colocou uma pedrinha na funda, girou bem forte e acertou bem na testa de Golias. O gigante caiu no ch√£o! Deus ajudou Davi porque ele confiou no Senhor. Quando confiamos em Deus, Ele nos ajuda a vencer qualquer problema!',
                paginas: [
                    { texto: 'Davi era um jovem pastor que cuidava das ovelhinhas...', ilustracao: 'ÔøΩÔøΩ' },
                    { texto: 'Um gigante chamado Golias estava assustando o povo de Deus...', ilustracao: 'üëπ' },
                    { texto: 'Davi confiou em Deus e disse que ia enfrentar o gigante...', ilustracao: 'üóø' },
                    { texto: 'Com apenas uma pedra e uma funda, Davi venceu Golias...', ilustracao: 'üéØ' },
                    { texto: 'Deus ajudou Davi porque ele confiou no Senhor!', ilustracao: 'üôå' }
                ]
            },
            'daniel-leoes': {
                titulo: 'Daniel na Cova dos Le√µes',
                textoCompleto: 'Daniel era um homem que amava muito a Deus e orava tr√™s vezes por dia. Ele sempre abria sua janela e orava olhando para Jerusal√©m. Algumas pessoas m√°s n√£o gostavam de Daniel e fizeram uma lei malvada: ningu√©m podia orar a Deus! Mas Daniel continuou orando porque sabia que era certo obedecer a Deus. As pessoas m√°s contaram para o rei que Daniel estava desobedecendo a lei. O rei ficou muito triste porque gostava de Daniel, mas teve que jog√°-lo na cova dos le√µes famintos. Mas Deus enviou um anjo para fechar a boca dos le√µes! Os le√µes n√£o fizeram nenhum mal para Daniel. Na manh√£ seguinte, o rei correu para ver Daniel e ficou muito feliz ao encontr√°-lo vivo! Daniel disse: "Meu Deus enviou um anjo para me proteger!" O rei tirou Daniel da cova e jogou as pessoas m√°s l√° dentro. Daniel foi salvo porque confiou em Deus e n√£o parou de orar!',
                paginas: [
                    { texto: 'Daniel era um homem que orava a Deus todos os dias...', ilustracao: 'üôè' },
                    { texto: 'Pessoas m√°s fizeram uma lei proibindo orar a Deus...', ilustracao: 'üìú' },
                    { texto: 'Daniel continuou orando porque amava a Deus...', ilustracao: '‚ù§Ô∏è' },
                    { texto: 'Jogaram Daniel na cova com le√µes famintos...', ilustracao: 'ÔøΩÔøΩ' },
                    { texto: 'Mas Deus enviou um anjo para proteger Daniel!', ilustracao: 'ÔøΩÔøΩ' }
                ]
            },
            'jonas-baleia': {
                titulo: 'Jonas e a Baleia',
                textoCompleto: 'Deus pediu para Jonas ir √† cidade de N√≠nive para falar sobre o amor de Deus para as pessoas. Mas Jonas teve medo e n√£o quis obedecer. Ele fugiu de navio para bem longe! Deus viu que Jonas estava desobedecendo e enviou uma grande tempestade no mar. As ondas eram enormes e o navio balan√ßava muito! Jonas sabia que a tempestade era por causa dele. Ele pediu para os marinheiros o jogarem no mar. Quando Jonas caiu na √°gua, Deus enviou uma baleia gigante que o engoliu inteirinho! Dentro da barriga da baleia, Jonas ficou tr√™s dias e tr√™s noites. L√° dentro, Jonas orou e pediu perd√£o a Deus. Ele prometeu obedecer e ir para N√≠nive. Deus ouviu a ora√ß√£o de Jonas e mandou a baleia cuspir Jonas na praia! Jonas foi para N√≠nive e falou sobre Deus para todas as pessoas. Elas se arrependeram e Deus as perdoou. Jonas aprendeu que sempre devemos obedecer a Deus!',
                paginas: [
                    { texto: 'Deus pediu para Jonas ir √† cidade de N√≠nive...', ilustracao: 'üèôÔ∏è' },
                    { texto: 'Mas Jonas teve medo e fugiu de navio...', ilustracao: '‚õµ' },
                    { texto: 'Deus enviou uma grande tempestade...', ilustracao: '‚õàÔ∏è' },
                    { texto: 'Jonas foi jogado ao mar e uma baleia o engoliu...', ilustracao: 'üêã' },
                    { texto: 'Dentro da baleia, Jonas orou e Deus o perdoou!', ilustracao: 'üôè' }
                ]
            },
            'nascimento-jesus': {
                titulo: 'O Nascimento de Jesus',
                textoCompleto: 'Maria era uma jovem muito especial que amava muito a Deus. Um dia, um anjo apareceu para ela com uma mensagem incr√≠vel: ela teria um beb√™ muito especial, o Filho de Deus! O beb√™ se chamaria Jesus e seria o Salvador do mundo. Maria ficou surpresa, mas disse: "Que seja feito conforme a vontade de Deus!" Jos√©, que ia casar com Maria, tamb√©m recebeu a visita de um anjo que explicou tudo. Jos√© e Maria tiveram que viajar para Bel√©m para se registrarem. Quando chegaram l√°, n√£o havia lugar na hospedaria. Eles tiveram que ficar em um est√°bulo com os animais. Foi l√° que Jesus nasceu! Maria o envolveu em panos e o colocou numa manjedoura. Naquela noite, anjos apareceram para os pastores no campo e disseram: "Nasceu o Salvador!" Os pastores correram para ver o beb√™ Jesus. Uma estrela muito brilhante apareceu no c√©u, guiando os reis magos at√© Jesus. Eles trouxeram presentes: ouro, incenso e mirra. Jesus veio ao mundo para nos salvar e mostrar o amor de Deus!',
                paginas: [
                    { texto: 'Maria era uma jovem que amava muito a Deus...', ilustracao: 'üë©' },
                    { texto: 'Um anjo apareceu e disse que ela teria um beb√™ especial...', ilustracao: 'ÔøΩÔøΩ' },
                    { texto: 'Jos√© e Maria viajaram para Bel√©m...', ilustracao: 'üê¥' },
                    { texto: 'Jesus nasceu em uma manjedoura, cercado de amor...', ilustracao: 'üë∂' },
                    { texto: 'Os anjos cantaram: "Gl√≥ria a Deus nas alturas!"', ilustracao: '‚≠ê' }
                ]
            }
        };

        let historiaAtual = null;
        let paginaAtual = 0;
        let audioTocando = false;
        let speechSynthesisUtterance = null; // Vari√°vel para controlar a fala

        // Fun√ß√£o de inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìö Sistema de hist√≥rias carregado!');
            
            // Adicionar event listeners para bot√µes de categoria
            document.querySelectorAll('.btn-categoria').forEach(btn => {
                btn.addEventListener('click', function(event) { // Adicionado 'event'
                    const categoria = this.getAttribute('data-categoria');
                    filtrarCategoria(categoria, event); // Passa o evento para a fun√ß√£o
                });
            });
            
            // Event listener para fechar modal
            const modal = document.getElementById('modal-historia');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        fecharHistoria();
                    }
                });
            }
            
            console.log('‚úÖ Event listeners configurados!');
        });

        // Filtrar categorias
        function filtrarCategoria(categoria, event) { // Recebe o evento
            console.log('üîç Filtrando categoria:', categoria);
            
            // Atualizar bot√µes de categoria (usando o evento para marcar o ativo)
            document.querySelectorAll('.btn-categoria').forEach(btn => {
                btn.classList.remove('active');
            });
            if (event && event.target) { // Verifica se event e event.target existem
                event.target.classList.add('active');
            } else {
                // Se n√£o h√° evento (chamada direta), tenta ativar o bot√£o 'Todas' por padr√£o
                const defaultBtn = document.querySelector(`.btn-categoria[data-categoria='${categoria}']`);
                if (defaultBtn) defaultBtn.classList.add('active');
            }
            
            // Filtrar cards das hist√≥rias
            document.querySelectorAll('.historia-card').forEach(card => {
                const categoriaCard = card.getAttribute('data-categoria');
                
                if (categoria === 'todas') {
                    card.style.display = 'block';
                } else if (categoriaCard && categoriaCard.includes(categoria)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
            console.log('‚úÖ Filtro aplicado para categoria:', categoria);
        }

        // Abrir hist√≥ria (para leitura visual, sem √°udio autom√°tico)
        function abrirHistoria(historiaId) {
            console.log('ÔøΩÔøΩ Abrindo hist√≥ria para leitura:', historiaId);
            abrirHistoriaModal(historiaId, false);
        }

        // Abrir hist√≥ria com √°udio (para audi√ß√£o autom√°tica)
        function abrirHistoriaComAudio(historiaId) {
            console.log('üéß Abrindo hist√≥ria com √°udio:', historiaId);
            abrirHistoriaModal(historiaId, true);
        }

        // L√≥gica principal para abrir o modal da hist√≥ria
        function abrirHistoriaModal(historiaId, comAudio) {
            pararAudio(); // Garante que qualquer √°udio anterior seja parado
            
            historiaAtual = historiasData[historiaId];
            if (!historiaAtual) {
                alert('Hist√≥ria n√£o encontrada!');
                console.error('‚ùå Hist√≥ria n√£o encontrada:', historiaId);
                return;
            }
            
            paginaAtual = 0; // Sempre come√ßa na primeira p√°gina visual
            
            document.getElementById('modal-historia').classList.remove('hidden');
            document.getElementById('historia-titulo').textContent = historiaAtual.titulo;
            carregarPagina(); // Carrega o conte√∫do visual da primeira p√°gina
            
            if (comAudio) {
                setTimeout(() => togglePlayPause(), 500); // Inicia o √°udio ap√≥s um pequeno delay
            }
            console.log('‚úÖ Modal da hist√≥ria aberta para:', historiaAtual.titulo, 'Com √°udio:', comAudio);
        }

        // Carrega o conte√∫do visual de uma p√°gina espec√≠fica da hist√≥ria
        function carregarPagina() {
            if (!historiaAtual || !historiaAtual.paginas || paginaAtual >= historiaAtual.paginas.length) {
                console.error('‚ùå Erro ao carregar p√°gina - dados inv√°lidos ou √≠ndice fora do limite.');
                return;
            }
            
            const pagina = historiaAtual.paginas[paginaAtual];
            
            document.getElementById('ilustracao-imagem').textContent = pagina.ilustracao;
            document.getElementById('texto-historia').innerHTML = `<p>${pagina.texto}</p>`;
            // O elemento 'pagina-atual' est√° oculto via CSS, ent√£o n√£o precisa ser atualizado visivelmente
            
            document.getElementById('btn-anterior').disabled = paginaAtual === 0;
            document.getElementById('btn-proximo').disabled = paginaAtual === historiaAtual.paginas.length - 1;
            console.log('üìÑ Conte√∫do visual da p√°gina carregado:', paginaAtual + 1);
        }

        // Navega√ß√£o visual: pr√≥xima p√°gina
        function proximaPagina() {
            if (historiaAtual && paginaAtual < historiaAtual.paginas.length - 1) {
                paginaAtual++;
                carregarPagina();
                console.log('‚û°Ô∏è Avan√ßou para p√°gina visual:', paginaAtual + 1);
            } else {
                console.log('‚ö†Ô∏è J√° est√° na √∫ltima p√°gina visual.');
            }
        }

        // Navega√ß√£o visual: p√°gina anterior
        function paginaAnterior() {
            if (historiaAtual && paginaAtual > 0) {
                paginaAtual--;
                carregarPagina();
                console.log('‚¨ÖÔ∏è Voltou para p√°gina visual:', paginaAtual + 1);
            } else {
                console.log('‚ö†Ô∏è J√° est√° na primeira p√°gina visual.');
            }
        }

        // Toggle para iniciar/pausar/retomar o √°udio (narra√ß√£o completa)
        function togglePlayPause() {
            if (!historiaAtual) {
                alert('Selecione uma hist√≥ria primeiro!');
                return;
            }
            
            const btn = document.getElementById('btn-play-pause');
            
            if (!audioTocando) {
                // Tenta iniciar a fala
                if (window.speechSynthesis.speaking && speechSynthesisUtterance) {
                    window.speechSynthesis.resume(); // Retomar se estiver pausado
                    console.log('‚ñ∂Ô∏è √Åudio retomado.');
                } else {
                    iniciarAudio(); // Iniciar do zero
                }
                btn.textContent = '‚è∏Ô∏è Pausar';
                audioTocando = true;
            } else {
                // Tenta pausar a fala
                if (window.speechSynthesis.speaking) {
                    window.speechSynthesis.pause();
                    console.log('‚è∏Ô∏è √Åudio pausado.');
                }
                btn.textContent = '‚ñ∂Ô∏è Ouvir Hist√≥ria';
                audioTocando = false;
            }
        }

        // FUN√á√ÉO CORRIGIDA: Narra√ß√£o completa em um √∫nico cap√≠tulo
        function iniciarAudio() {
            if (!window.speechSynthesis) {
                alert('√Åudio n√£o suportado neste navegador. Tente outro navegador ou atualize o seu.');
                console.error('‚ùå SpeechSynthesis API n√£o dispon√≠vel.');
                return;
            }
            
            console.log('üé§ Tentando iniciar narra√ß√£o completa da hist√≥ria:', historiaAtual.titulo);
            
            window.speechSynthesis.cancel(); // Cancela qualquer fala anterior ou em andamento
            
            // Usa o texto completo da hist√≥ria
            speechSynthesisUtterance = new SpeechSynthesisUtterance(historiaAtual.textoCompleto);
            speechSynthesisUtterance.lang = 'pt-BR';
            speechSynthesisUtterance.rate = 0.8; // Velocidade da fala
            speechSynthesisUtterance.pitch = 1.0; // Tom da voz
            speechSynthesisUtterance.volume = 1.0; // Volume
            
            // Tenta encontrar uma voz em portugu√™s do Brasil
            const voices = window.speechSynthesis.getVoices();
            const portugueseVoice = voices.find(voice => 
                voice.lang === 'pt-BR' || voice.lang.startsWith('pt-')
            );
            
            if (portugueseVoice) {
                speechSynthesisUtterance.voice = portugueseVoice;
                console.log('üáßüá∑ Voz em portugu√™s selecionada:', portugueseVoice.name);
            } else {
                console.warn('‚ö†Ô∏è Nenhuma voz pt-BR encontrada. Usando voz padr√£o do sistema.');
            }
            
            speechSynthesisUtterance.onstart = () => {
                console.log('‚úÖ Narra√ß√£o completa iniciada!');
                audioTocando = true;
                document.getElementById('btn-play-pause').textContent = '‚è∏Ô∏è Pausar';
            };
            
            speechSynthesisUtterance.onend = () => {
                console.log('‚úÖ Narra√ß√£o completa finalizada!');
                audioTocando = false;
                document.getElementById('btn-play-pause').textContent = '‚ñ∂Ô∏è Ouvir Hist√≥ria';
            };
            
            speechSynthesisUtterance.onerror = (event) => {
                console.error('‚ùå Erro na narra√ß√£o da hist√≥ria:', event.error);
                alert('Erro na narra√ß√£o: ' + event.error + '. Por favor, tente novamente ou verifique as configura√ß√µes de √°udio do seu navegador.');
                audioTocando = false;
                document.getElementById('btn-play-pause').textContent = '‚ñ∂Ô∏è Ouvir Hist√≥ria';
            };
            
            // Inicia a fala
            window.speechSynthesis.speak(speechSynthesisUtterance);
            console.log('üéµ Comando de fala enviado para a API.');
        }

        // Para completamente o √°udio e reseta o bot√£o
        function pararAudio() {
            if (window.speechSynthesis.speaking || window.speechSynthesis.pending) {
                window.speechSynthesis.cancel();
                console.log('‚èπÔ∏è √Åudio cancelado.');
            }
            audioTocando = false;
            if (document.getElementById('btn-play-pause')) {
                document.getElementById('btn-play-pause').textContent = '‚ñ∂Ô∏è Ouvir Hist√≥ria';
            }
            speechSynthesisUtterance = null; // Reseta o utterance
        }

        // Fecha o modal da hist√≥ria
        function fecharHistoria() {
            pararAudio(); // Garante que o √°udio pare ao fechar o modal
            document.getElementById('modal-historia').classList.add('hidden');
            historiaAtual = null;
            paginaAtual = 0;
            console.log('‚ùå Modal da hist√≥ria fechado.');
        }

        // Imprime o conte√∫do da hist√≥ria
        function imprimirHistoria() {
            if (!historiaAtual) {
                alert('Nenhuma hist√≥ria selecionada para imprimir.');
                return;
            }
            
            const janela = window.open('', '_blank');
            janela.document.write(`
                <html>
                <head>
                    <title>${historiaAtual.titulo}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
                        h1 { color: #2E8B57; text-align: center; margin-bottom: 30px; }
                        .historia { font-size: 16px; text-align: justify; }
                        .ilustracao { text-align: center; font-size: 3rem; margin: 20px 0; }
                    </style>
                </head>
                <body>
                    <h1>${historiaAtual.titulo}</h1>
                    <div class="ilustracao">${historiaAtual.paginas[0].ilustracao}</div> <!-- Usa a ilustra√ß√£o da primeira p√°gina -->
                    <div class="historia">${historiaAtual.textoCompleto}</div>
                    <br><br>
                    <p style="text-align: center; color: #666; font-style: italic;">
                        Igreja Cristo Vive - Minist√©rio Infantil Pequenos Disc√≠pulos<br>
                        Paracambi/RJ
                    </p>
                </body>
                </html>
            `);
            janela.document.close();
            janela.print();
            console.log('üñ®Ô∏è Hist√≥ria enviada para impress√£o:', historiaAtual.titulo);
        }
    </script>
</body>
</html>