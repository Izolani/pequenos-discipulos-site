// Dados dos jograis
const jograisData = {
    'natal-jesus': {
        titulo: 'O Nascimento de Jesus',
        categoria: 'natal',
        participantes: '4-6 crian√ßas',
        duracao: '3 min',
        texto: `JOGRAL: O NASCIMENTO DE JESUS

CRIAN√áA 1: Era uma noite muito especial em Bel√©m
CRIAN√áA 2: Maria e Jos√© procuravam um lugar para ficar
CRIAN√áA 3: Mas n√£o havia lugar na hospedaria
CRIAN√áA 4: Ent√£o foram para um est√°bulo descansar

TODAS: E ali nasceu Jesus, nosso Salvador!

CRIAN√áA 1: Os anjos cantaram no c√©u
CRIAN√áA 2: "Gl√≥ria a Deus nas alturas!"
CRIAN√áA 3: Os pastores correram para ver
CRIAN√áA 4: O menino Jesus que nos ama

TODAS: Jesus nasceu para nos salvar!
TODAS: Aleluia! Aleluia! Jesus nasceu!

(Podem cantar uma m√∫sica de Natal no final)`
    },
    'estrela-belem': {
        titulo: 'A Estrela de Bel√©m',
        categoria: 'natal',
        participantes: '3-5 crian√ßas',
        duracao: '2 min',
        texto: `JOGRAL: A ESTRELA DE BEL√âM

CRIAN√áA 1: Uma estrela muito brilhante apareceu no c√©u
CRIAN√áA 2: Era diferente de todas as outras
CRIAN√áA 3: Os reis magos a viram de longe

TODAS: E seguiram a estrela especial!

CRIAN√áA 1: Eles trouxeram presentes preciosos
CRIAN√áA 2: Ouro, incenso e mirra
CRIAN√áA 3: Para o menino Jesus

TODAS: A estrela os guiou at√© Jesus!
TODAS: Jesus √© a luz do mundo!`
    },
    'ressurreicao': {
        titulo: 'Jesus Ressuscitou',
        categoria: 'pascoa',
        participantes: '5-7 crian√ßas',
        duracao: '4 min',
        texto: `JOGRAL: JESUS RESSUSCITOU

CRIAN√áA 1: Jesus morreu na cruz por n√≥s
CRIAN√áA 2: Ele foi sepultado em um t√∫mulo
CRIAN√áA 3: Mas no terceiro dia...
CRIAN√áA 4: Algo maravilhoso aconteceu!

TODAS: JESUS RESSUSCITOU!

CRIAN√áA 5: As mulheres foram ao t√∫mulo
CRIAN√áA 6: Mas Jesus n√£o estava l√°!
CRIAN√áA 7: Um anjo disse: "Ele ressuscitou!"

TODAS: Jesus venceu a morte!
TODAS: Ele est√° vivo para sempre!
TODAS: Aleluia! Cristo ressuscitou!`
    },
    'cruz-amor': {
        titulo: 'A Cruz do Amor',
        categoria: 'pascoa',
        participantes: '4-6 crian√ßas',
        duracao: '3 min',
        texto: `JOGRAL: A CRUZ DO AMOR

CRIAN√áA 1: Jesus nos ama muito
CRIAN√áA 2: Ele morreu na cruz por n√≥s
CRIAN√áA 3: Para perdoar nossos pecados
CRIAN√áA 4: E nos dar vida eterna

TODAS: Que grande amor √© esse!

CRIAN√áA 1: Na cruz Jesus sofreu
CRIAN√áA 2: Mas era por amor a n√≥s
CRIAN√áA 3: Ele pagou o pre√ßo
CRIAN√áA 4: Para sermos filhos de Deus

TODAS: Obrigado Jesus pelo seu amor!
TODAS: A cruz nos mostra quanto Deus nos ama!`
    },
    'criancas-especiais': {
        titulo: 'Crian√ßas Especiais',
        categoria: 'dia-criancas',
        participantes: '6-8 crian√ßas',
        duracao: '3 min',
        texto: `JOGRAL: CRIAN√áAS ESPECIAIS

CRIAN√áA 1: Somos crian√ßas especiais
CRIAN√áA 2: Deus nos fez com muito amor
CRIAN√áA 3: Cada uma √© √∫nica
CRIAN√áA 4: E tem um valor especial

TODAS: Deus nos ama como somos!

CRIAN√áA 5: Ele conhece nosso nome
CRIAN√áA 6: E conta nossos cabelos
CRIAN√áA 7: Somos preciosas para Ele
CRIAN√áA 8: Como joias no seu tesouro

TODAS: Somos filhos de Deus!
TODAS: Especiais e amados!
TODAS: Obrigado Deus por nos amar!`
    },
    'biblia-palavra': {
        titulo: 'A B√≠blia √© a Palavra de Deus',
        categoria: 'geral',
        participantes: '4-6 crian√ßas',
        duracao: '3 min',
        texto: `JOGRAL: A B√çBLIA √â A PALAVRA DE DEUS

CRIAN√áA 1: A B√≠blia √© um livro especial
CRIAN√áA 2: √â a Palavra de Deus para n√≥s
CRIAN√áA 3: Nela aprendemos sobre Jesus
CRIAN√áA 4: E como viver para Deus

TODAS: A B√≠blia √© nossa luz!

CRIAN√áA 1: Ela nos ensina o que √© certo
CRIAN√áA 2: E nos mostra o caminho
CRIAN√áA 3: Devemos ler todos os dias
CRIAN√áA 4: E guardar no cora√ß√£o

TODAS: A Palavra de Deus √© viva!
TODAS: Ela transforma nossa vida!`
    },
    'oracao-poder': {
        titulo: 'O Poder da Ora√ß√£o',
        categoria: 'geral',
        participantes: '3-5 crian√ßas',
        duracao: '2 min',
        texto: `JOGRAL: O PODER DA ORA√á√ÉO

CRIAN√áA 1: Ora√ß√£o √© conversar com Deus
CRIAN√áA 2: Podemos falar com Ele a qualquer hora
CRIAN√áA 3: Ele sempre nos escuta

TODAS: Deus ouve nossas ora√ß√µes!

CRIAN√áA 1: Podemos agradecer a Deus
CRIAN√áA 2: Pedir perd√£o pelos erros
CRIAN√áA 3: E pedir ajuda quando precisamos

TODAS: A ora√ß√£o tem poder!
TODAS: Vamos sempre orar!`
    }
};

// Vari√°veis globais
let jogralAtual = null;

// Mostrar categoria - CORRIGIDA
function mostrarCategoria(categoria) {
    console.log('Mostrando categoria:', categoria);
    
    // Atualizar tabs
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Marcar tab ativo
    if (event && event.target) {
        event.target.classList.add('active');
    }
    
    // Esconder todas as categorias
    document.querySelectorAll('.categoria-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Mostrar categoria selecionada
    const categoriaElement = document.getElementById(`categoria-${categoria}`);
    if (categoriaElement) {
        categoriaElement.classList.add('active');
        console.log(`Categoria ${categoria} ativada`);
    } else {
        console.error(`Categoria ${categoria} n√£o encontrada`);
    }
}

// Abrir jogral - CORRIGIDA
function abrirJogral(jogralId) {
    console.log('Tentando abrir jogral:', jogralId);
    
    // Verificar se o jogral existe
    if (!jograisData[jogralId]) {
        console.error('Jogral n√£o encontrado:', jogralId);
        alert('Jogral n√£o encontrado: ' + jogralId);
        return;
    }
    
    jogralAtual = jograisData[jogralId];
    console.log('Jogral carregado:', jogralAtual.titulo);
    
    // Verificar se o modal existe
    const modal = document.getElementById('modal-jogral');
    if (!modal) {
        console.error('Modal do jogral n√£o encontrado!');
        
        // Criar modal dinamicamente se n√£o existir
        criarModalJogral();
        return abrirJogral(jogralId); // Tentar novamente
    }
    
    // Atualizar conte√∫do do modal
    const tituloElement = document.getElementById('jogral-titulo');
    const participantesElement = document.getElementById('jogral-participantes');
    const duracaoElement = document.getElementById('jogral-duracao');
    const textoElement = document.getElementById('jogral-texto');
    
    if (tituloElement) tituloElement.textContent = jogralAtual.titulo;
    if (participantesElement) participantesElement.textContent = jogralAtual.participantes;
    if (duracaoElement) duracaoElement.textContent = jogralAtual.duracao;
    if (textoElement) textoElement.textContent = jogralAtual.texto;
    
    // Mostrar modal
    modal.classList.remove('hidden');
    console.log('Modal do jogral aberto');
}

// Criar modal dinamicamente se n√£o existir
function criarModalJogral() {
    const modalHTML = `
        <div id="modal-jogral" class="modal-jogral hidden">
            <div class="modal-content-jogral">
                <div class="modal-header-jogral">
                    <h2 id="jogral-titulo">T√≠tulo do Jogral</h2>
                    <div class="modal-controles">
                        <button class="btn-imprimir" onclick="imprimirJogral()">üñ®Ô∏è Imprimir</button>
                        <button class="btn-copiar" onclick="copiarTexto()">üìã Copiar</button>
                        <button class="btn-fechar-jogral" onclick="fecharJogral()">‚ùå Fechar</button>
                    </div>
                </div>
                <div class="modal-body-jogral">
                    <div class="jogral-info-modal">
                        <p><strong>Participantes:</strong> <span id="jogral-participantes">-</span></p>
                        <p><strong>Dura√ß√£o:</strong> <span id="jogral-duracao">-</span></p>
                    </div>
                    <div class="jogral-texto" id="jogral-texto">
                        Carregando jogral...
                    </div>
                    <div class="jogral-rodape">
                        <p>Igreja Cristo Vive de Paracambi/RJ - Minist√©rio Infantil - Pequenos Disc√≠pulos</p>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHTML);
    console.log('Modal do jogral criado dinamicamente');
}

// Fechar jogral
function fecharJogral() {
    const modal = document.getElementById('modal-jogral');
    if (modal) {
        modal.classList.add('hidden');
        console.log('Modal do jogral fechado');
    }
    jogralAtual = null;
}

// Imprimir jogral
function imprimirJogral() {
    if (!jogralAtual) {
        alert('Nenhum jogral selecionado!');
        return;
    }
    
    const conteudo = `
        <html>
        <head>
            <title>${jogralAtual.titulo}</title>
            <style>
                body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
                h1 { color: #2E8B57; text-align: center; margin-bottom: 30px; }
                .info { text-align: center; margin-bottom: 30px; color: #666; }
                .texto { font-family: 'Courier New', monospace; white-space: pre-line; font-size: 14px; }
                .rodape { margin-top: 30px; text-align: center; font-size: 12px; color: #999; border-top: 1px solid #ddd; padding-top: 20px; }
            </style>
        </head>
        <body>
            <h1>${jogralAtual.titulo}</h1>
            <div class="info">
                <p><strong>Participantes:</strong> ${jogralAtual.participantes} | <strong>Dura√ß√£o:</strong> ${jogralAtual.duracao}</p>
            </div>
            <div class="texto">${jogralAtual.texto}</div>
            <div class="rodape">
                <p>Igreja Cristo Vive de Paracambi/RJ - Minist√©rio Infantil - Pequenos Disc√≠pulos</p>
            </div>
        </body>
        </html>
    `;
    
    const janela = window.open('', '_blank');
    janela.document.write(conteudo);
    janela.document.close();
    janela.print();
    
    console.log('Jogral enviado para impress√£o');
}

// Copiar texto
function copiarTexto() {
    if (!jogralAtual) {
        alert('Nenhum jogral selecionado!');
        return;
    }
    
    const texto = `${jogralAtual.titulo}\n\nParticipantes: ${jogralAtual.participantes}\nDura√ß√£o: ${jogralAtual.duracao}\n\n${jogralAtual.texto}\n\nIgreja Cristo Vive de Paracambi/RJ - Minist√©rio Infantil - Pequenos Disc√≠pulos`;
    
    if (navigator.clipboard) {
        navigator.clipboard.writeText(texto).then(() => {
            alert('Texto copiado para a √°rea de transfer√™ncia!');
        }).catch(() => {
            copiarTextoFallback(texto);
        });
    } else {
        copiarTextoFallback(texto);
    }
}

// Fallback para copiar texto
function copiarTextoFallback(texto) {
    const textarea = document.createElement('textarea');
    textarea.value = texto;
    document.body.appendChild(textarea);
    textarea.select();
    
    try {
        document.execCommand('copy');
        alert('Texto copiado!');
    } catch (err) {
        alert('Erro ao copiar texto. Tente selecionar e copiar manualmente.');
    }
    
    document.body.removeChild(textarea);
}

// Inicializa√ß√£o - CORRIGIDA
document.addEventListener('DOMContentLoaded', function() {
    console.log('Jograis carregados!');
    console.log('Jograis dispon√≠veis:', Object.keys(jograisData));
    
    // Verificar se as categorias existem
    const categorias = ['natal', 'pascoa', 'dia-criancas', 'geral'];
    categorias.forEach(categoria => {
        const elemento = document.getElementById(`categoria-${categoria}`);
        if (!elemento) {
            console.warn(`Categoria n√£o encontrada: categoria-${categoria}`);
        } else {
            console.log(`Categoria encontrada: categoria-${categoria}`);
        }
    });
    
    // Adicionar event listeners para os tabs
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const categoria = this.textContent.split(' ')[1]?.toLowerCase() || 
                             this.textContent.toLowerCase().replace(/[^a-z]/g, '');
            mostrarCategoria(categoria);
        });
    });
});

// Fun√ß√£o global para debug
window.debugJograis = function() {
    console.log('=== DEBUG JOGRAIS ===');
    console.log('Jograis dispon√≠veis:', Object.keys(jograisData));
    console.log('Jogral atual:', jogralAtual);
    console.log('Modal existe:', !!document.getElementById('modal-jogral'));
    console.log('====================');
};